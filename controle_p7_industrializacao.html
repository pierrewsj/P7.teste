<!DOCTYPE html><html lang="pt-BR"><head><meta charset="utf-8"/><meta content="width=device-width, initial-scale=1.0" name="viewport"/><title>Portaria 07 - Controle de Chassi</title><script src="https://cdn.sheetjs.com/xlsx-latest/package/dist/xlsx.full.min.js"></script><script src="https://cdn.jsdelivr.net/npm/exceljs/dist/exceljs.min.js"></script><script src="https://cdn.jsdelivr.net/npm/file-saver/dist/FileSaver.min.js"></script><script src="https://cdn.jsdelivr.net/npm/feather-icons/dist/feather.min.js"></script><link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@500;700&amp;display=swap" rel="stylesheet"/><style> :root { --cor-fundo: #0b1d30; --cor-caixa: #1c2b3d; --cor-primaria: #00d2ff; --cor-hover: #1a4ed8; --cor-texto: #ffffff; --cor-alerta: #f0ad4e; --cor-erro: #ff4444; } * { box-sizing: border-box; } body { margin: 0; padding: 1rem; font-family: 'Orbitron', sans-serif; background-color: var(--cor-fundo); background-image: radial-gradient(circle at top left, #1b2735, #090a0f); color: var(--cor-texto); } .container { max-width: 920px; margin: auto; background: rgba(28,43,61,0.6); backdrop-filter: blur(15px); border: 1px solid rgba(0,212,255,0.15); padding: 2rem; border-radius: 20px; box-shadow: 0 0 30px rgba(0,255,255,0.15), inset 0 0 10px rgba(0,255,255,0.05); display: flex; flex-direction: column; gap: 1.5rem; animation: fadeIn 0.6s ease-in-out; } h1 { font-size: 1.8rem; letter-spacing: 6px; background: linear-gradient(90deg, var(--cor-primaria), #3a7bd5); -webkit-background-clip: text; -webkit-text-fill-color: transparent; font-weight: 800; font-family: 'Orbitron', sans-serif; text-shadow: 0 0 10px rgba(0,210,255,0.5); margin-bottom: 0.5rem; text-align: center; } h2 { font-size: 1.2rem; font-weight: 600; letter-spacing: 2px; text-transform: uppercase; color: var(--cor-primaria); opacity: 0.85; margin-bottom: 1.5rem; font-family: 'Orbitron', sans-serif; text-align: center; } h3 { font-size: 1rem; font-weight: 500; letter-spacing: 1px; color: var(--cor-primaria); opacity: 0.85; margin-bottom: 1rem; text-align: center; } label { font-weight: 600; font-size: 0.95rem; display: flex; flex-direction: column; margin-top: 0.5rem; font-family: Arial, sans-serif; position: relative; } input, select { margin-top: 0.4rem; padding: 0.7rem; border: 1px solid #00d2ff44; border-radius: 12px; font-size: 1rem; background: rgba(0,0,0,0.35); color: #fff; backdrop-filter: blur(4px); box-shadow: inset 0 0 8px rgba(0,210,255,0.1); transition: all .2s; font-family: Arial, sans-serif; } #numeroChassi { padding-right: 108px; } #chassiConfirmIcon { display: none; position: absolute; right: -32px; top: 14px; width: 90px; height: 90px; font-size: 4.5rem; color: #35ff5a; z-index: 10; pointer-events: none; background: rgba(255,255,255,0.78); border-radius: 50%; box-shadow: 0 0 35px 14px #26e76e99, 0 0 0 6px #57ffa755; transition: opacity 0.25s, transform 0.17s; opacity: 0; transform: scale(0.7); display: flex; align-items: center; justify-content: center; } #chassiConfirmIcon.visible { display: flex; opacity: 1; transform: scale(1.16); animation: confirmpop 0.34s cubic-bezier(.68,-0.55,.27,1.55); } @keyframes confirmpop { 0% { opacity:0; transform: scale(0.5);} 60% { opacity:1; transform: scale(1.32);} 85% { transform: scale(1);} 100% { transform: scale(1.16);} } button { background: linear-gradient(135deg, #3a7bd5, var(--cor-primaria)); color: #fff; border: 1px solid var(--cor-primaria); padding: .75rem 1.5rem; border-radius: 14px; font-size: 1rem; font-weight: 600; display: inline-flex; align-items: center; gap: .5rem; cursor: pointer; box-shadow: 0 0 6px var(--cor-primaria)66, 0 0 10px var(--cor-primaria)33; transition: all .3s; font-family: 'Orbitron', sans-serif; } button:hover { background: linear-gradient(135deg, var(--cor-primaria), #3a7bd5); box-shadow: 0 0 20px rgba(0,210,255,.85); transform: scale(1.05); } button i { vertical-align: middle; stroke-width: 2; } .button-group { display: flex; flex-wrap: wrap; justify-content: center; gap: .75rem; } .auto-save-icon { text-align: right; font-size: .85rem; color: #55dd55; font-family: Arial, sans-serif; } .info { font-weight: bold; text-align: center; color: var(--cor-alerta); font-family: Arial, sans-serif; } .info[aria-live] { min-height: 1.2em; } #tabelaContainer { display: none; } table { width: 100%; border-collapse: collapse; margin-top: 1rem; font-size: .95rem; font-family: Arial, sans-serif; } th, td { border: 1px solid #2e3c51; padding: .6rem; text-align: center; color: var(--cor-texto); } th { background: #233246; color: var(--cor-primaria); } @media(max-width:600px) { .container { padding: 1rem; } .button-group { flex-direction: column; } button { width: 100%; justify-content: center; } .auto-save-icon { text-align: center; margin-top: .5rem; } } @keyframes fadeIn { from { opacity: 0; transform: translateY(15px); } to { opacity: 1; transform: translateY(0); } } #botoesInternos { display: none; flex-direction: column; gap: .75rem; justify-content: center; margin-bottom: 1rem; } /* ===== Melhoria Visual: Campos bloqueados + tooltip + contraste ===== */ :root{ --locked-badge-bg: rgba(255,255,255,.06); --locked-badge-br: 1px solid #ffffff22; --tooltip-bg: rgba(0,0,0,.85); --tooltip-br: 1px solid #ffffff22; } /* Contraste mais claro para campos edit√°veis */ input:not([readonly]), select:not([disabled]), textarea:not([readonly]){ border-color: #00d2ff66 !important; box-shadow: 0 0 0 1px #00d2ff22 inset; } /* Apar√™ncia consistente para bloqueados (somente leitura) */ input[readonly], textarea[readonly]{ cursor: not-allowed !important; opacity: .65; filter: saturate(85%); box-shadow: inset 0 0 0 1px #ffffff22 !important; } /* Badge e √≠cone de cadeado posicionados dentro do label */ .lock-indicator{ position: absolute; right: .6rem; top: .2rem; display: inline-flex; align-items: center; gap: .35rem; font-size: .72rem; letter-spacing: .06em; text-transform: uppercase; opacity: .8; padding: .18rem .45rem; background: var(--locked-badge-bg); border: var(--locked-badge-br); border-radius: 8px; user-select: none; pointer-events: none; } /* Tooltip estilizado */ .has-tooltip{ position: relative; } .has-tooltip::after{ content: attr(data-tooltip); position: absolute; left: 0; top: calc(100% + .35rem); white-space: nowrap; background: var(--tooltip-bg); color: #fff; font-size: .8rem; padding: .35rem .55rem; border-radius: 8px; border: var(--tooltip-br); opacity: 0; transform: translateY(-3px); transition: opacity .18s ease, transform .18s ease; pointer-events: none; z-index: 30; } .has-tooltip:hover::after, .has-tooltip:focus-within::after{ opacity: 1; transform: translateY(0); } </style><style> :root { --cor-fundo: #0b1d30; --cor-caixa: #1c2b3d; --cor-primaria: #00d2ff; --cor-texto: #ffffff; --cor-secundaria: #FFA726; } button:hover, .btn-primary:hover { background: var(--cor-secundaria) !important; box-shadow: 0 4px 12px rgba(255,167,38,0.4); transition: background 0.3s ease, box-shadow 0.3s ease; } #toast-container { position: fixed; top: 1rem; right: 1rem; display: flex; flex-direction: column; gap: 0.5rem; z-index: 9999; pointer-events: none; } .toast { display: flex; align-items: center; padding: 0.75rem 1rem; background: var(--cor-secundaria); color: #fff; border-radius: 0.375rem; box-shadow: 0 2px 8px rgba(0,0,0,0.2); animation: slideIn 0.4s ease-out, fadeOut 0.4s ease-in 2.6s forwards; pointer-events: auto; } @keyframes slideIn { from { transform: translateX(100%); opacity: 0; } to { transform: translateX(0); opacity: 1; } } @keyframes fadeOut { to { opacity: 0; transform: translateY(-10px); } } /* Modal styles */ .modal-overlay { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.5); display: none; align-items: center; justify-content: center; z-index: 10000; } .modal-container { background: var(--cor-caixa); padding: 1.5rem; border-radius: 8px; width: 90%; max-width: 400px; box-shadow: 0 0 10px rgba(0,0,0,0.3); } .modal-header { font-size: 1.25rem; font-weight: 700; margin-bottom: 0.5rem; color: var(--cor-primaria); } .modal-body { margin-bottom: 1rem; color: #fff; } .modal-footer { display: flex; justify-content: flex-end; gap: 0.5rem; } .btn-modal { padding: 0.5rem 1rem; border: none; border-radius: 4px; font-weight: 600; cursor: pointer; } .btn-primary { background: var(--cor-primaria); color: #000; } .btn-secondary { background: var(--cor-secundaria); color: #fff; } </style><script> (function(){ document.addEventListener('contextmenu', e => e.preventDefault(), true); document.addEventListener('keydown', function(e){ const k = e.key.toLowerCase(); const ctrl = e.ctrlKey || e.metaKey; if (k === 'f12') { e.preventDefault(); return; } if (ctrl && ['s','u','p','c','a','j','i'].includes(k)) { e.preventDefault(); return; } if (e.shiftKey && ctrl && ['i','j','c'].includes(k)) { e.preventDefault(); return; } }, true); setInterval(function(){ const threshold = 160; if (window.outerWidth - window.innerWidth > threshold || window.outerHeight - window.innerHeight > threshold){ console.warn('DevTools detectado.'); } }, 1200); })(); </script></head><body><div class="container"><h1>STELLANTIS</h1><h2>Seguran√ßa Patrimonial</h2><h3>Controle de Ve√≠culos - Industrializa√ß√£o</h3><label>Setor: <input id="setor" type="text" value="Portaria 07" readonly tabindex="-1" inputmode="none"/></label><label>Turno: <input id="turno" readonly tabindex="-1" inputmode="none"/></label><label style="position: relative;"> N√∫mero de chassi: <input autocomplete="off" autofocus="" id="numeroChassi" style="padding-right: 108px;" type="text"><span id="chassiConfirmIcon"><i data-feather="check-circle"></i></span></input></label><label>Controlador de acesso: <input id="controladorAcesso" type="text" readonly tabindex="-1" inputmode="none"/></label><div aria-live="polite" class="info" id="info"></div><div class="auto-save-icon">üíæ Salvamento autom√°tico</div><div class="button-group"><button id="btnOutrasInfos" onclick="acessarOutrasInfos()"><i data-feather="menu"></i>Outras informa√ß√µes</button><button id="btnToggleTabela" onclick="toggleTabela()"><i data-feather="eye"></i>Visualizar Tabela</button><button onclick="sair()"><i data-feather="log-out"></i>Sair</button></div><div class="button-group" id="botoesInternos"><button id="btnAdicionar" onclick="adicionarItem()"><i data-feather="plus-circle"></i>Adicionar</button><button id="btnDesfazer" onclick="desfazerUltimo()"><i data-feather="rotate-ccw"></i>Desfazer</button><button id="btnEditarSenha" onclick="editarSenha()"><i data-feather="key"></i>Editar senha</button><button id="btnFecharBotoesInternos" onclick="ocultarBotoesInternos()"><i data-feather="x"></i>Fechar</button></div><div id="totalVeiculos" style="font-weight:bold; color:#00d2ff; text-align:center; font-size:1.7rem; margin-top:12px;">Total de ve√≠culos: 0</div><div id="tabelaContainer"><table id="tabelaChassi"><thead><tr><th>Setor</th><th>Turno</th><th>Controlador de acesso</th><th>N√∫mero de chassi</th><th>Data e Hora</th></tr></thead><tbody></tbody></table></div></div><div class="modal-overlay" id="modalOverlay"><div class="modal-container"><div class="modal-header" id="modalHeader"></div><div class="modal-body" id="modalBody"></div><div class="modal-footer" id="modalFooter"><button class="btn-modal btn-secondary" id="modalCancel">Cancelar</button><button class="btn-modal btn-primary" id="modalConfirm">OK</button></div></div></div><script>eval(atob('Ly8gQ2hhdmUgZGUgYXJtYXplbmFtZW50byBlc3BlY8OtZmljYSBkYSBww6FnaW5hCiAgY29uc3Qgc3RvcmFnZUtleSA9ICd0YWJlbGFDaGFzc2knOw=='))</script><script>eval(atob('YXN5bmMgZnVuY3Rpb24gc2hvd01vZGFsKG1lc3NhZ2UpIHsKICByZXR1cm4gbmV3IFByb21pc2UocmVzb2x2ZSA9PiB7CiAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnbW9kYWxIZWFkZXInKS50ZXh0Q29udGVudCA9ICcnOwogICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ21vZGFsQm9keScpLnRleHRDb250ZW50ID0gbWVzc2FnZTsKICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdtb2RhbENhbmNlbCcpLnN0eWxlLmRpc3BsYXkgPSAnbm9uZSc7CiAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnbW9kYWxDb25maXJtJykudGV4dENvbnRlbnQgPSAnT0snOwogICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ21vZGFsQ29uZmlybScpLm9uY2xpY2sgPSAoKSA9PiB7CiAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdtb2RhbE92ZXJsYXknKS5zdHlsZS5kaXNwbGF5ID0gJ25vbmUnOwogICAgICByZXNvbHZlKCk7CiAgICB9OwogICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ21vZGFsT3ZlcmxheScpLnN0eWxlLmRpc3BsYXkgPSAnZmxleCc7CiAgfSk7Cn0KYXN5bmMgZnVuY3Rpb24gc2hvd0NvbmZpcm0obWVzc2FnZSkgewogIHJldHVybiBuZXcgUHJvbWlzZShyZXNvbHZlID0+IHsKICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdtb2RhbEhlYWRlcicpLnRleHRDb250ZW50ID0gJ0NvbmZpcm1hw6fDo28nOwogICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ21vZGFsQm9keScpLnRleHRDb250ZW50ID0gbWVzc2FnZTsKICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdtb2RhbENhbmNlbCcpLnN0eWxlLmRpc3BsYXkgPSAnaW5saW5lLWJsb2NrJzsKICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdtb2RhbENvbmZpcm0nKS50ZXh0Q29udGVudCA9ICdTaW0nOwogICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ21vZGFsQ2FuY2VsJykudGV4dENvbnRlbnQgPSAnTsOjbyc7CiAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnbW9kYWxDb25maXJtJykub25jbGljayA9ICgpID0+IHsgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ21vZGFsT3ZlcmxheScpLnN0eWxlLmRpc3BsYXkgPSAnbm9uZSc7IHJlc29sdmUodHJ1ZSk7IH07CiAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnbW9kYWxDYW5jZWwnKS5vbmNsaWNrID0gKCkgPT4geyBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnbW9kYWxPdmVybGF5Jykuc3R5bGUuZGlzcGxheSA9ICdub25lJzsgcmVzb2x2ZShmYWxzZSk7IH07CiAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnbW9kYWxPdmVybGF5Jykuc3R5bGUuZGlzcGxheSA9ICdmbGV4JzsKICB9KTsKfQphc3luYyBmdW5jdGlvbiBzaG93UHJvbXB0KG1lc3NhZ2UpIHsKICByZXR1cm4gbmV3IFByb21pc2UocmVzb2x2ZSA9PiB7CiAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnbW9kYWxIZWFkZXInKS50ZXh0Q29udGVudCA9ICdFbnRyYWRhIGRlIGRhZG9zJzsKICAgIGNvbnN0IGJvZHkgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnbW9kYWxCb2R5Jyk7CiAgICBib2R5LmlubmVySFRNTCA9IGA8cD4ke21lc3NhZ2V9PC9wPjxpbnB1dCB0eXBlPSJ0ZXh0IiBpZD0ibW9kYWxJbnB1dCIgc3R5bGU9IndpZHRoOjEwMCU7IHBhZGRpbmc6MC41cmVtOyBtYXJnaW4tdG9wOjAuNXJlbTsgYm9yZGVyLXJhZGl1czo0cHg7IGJvcmRlcjoxcHggc29saWQgI2NjYzsiPmA7CiAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnbW9kYWxDYW5jZWwnKS5zdHlsZS5kaXNwbGF5ID0gJ2lubGluZS1ibG9jayc7CiAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnbW9kYWxDb25maXJtJykudGV4dENvbnRlbnQgPSAnT0snOwogICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ21vZGFsQ29uZmlybScpLm9uY2xpY2sgPSAoKSA9PiB7IGNvbnN0IHZhbCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdtb2RhbElucHV0JykudmFsdWU7IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdtb2RhbE92ZXJsYXknKS5zdHlsZS5kaXNwbGF5ID0gJ25vbmUnOyByZXNvbHZlKHZhbCk7IH07CiAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnbW9kYWxDYW5jZWwnKS5vbmNsaWNrID0gKCkgPT4geyBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnbW9kYWxPdmVybGF5Jykuc3R5bGUuZGlzcGxheSA9ICdub25lJzsgcmVzb2x2ZShudWxsKTsgfTsKICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdtb2RhbE92ZXJsYXknKS5zdHlsZS5kaXNwbGF5ID0gJ2ZsZXgnOwogIH0pOwp9'))</script><script>eval(atob('bGV0IHNlbmhhT3V0cmFzSW5mb3MgPSBsb2NhbFN0b3JhZ2UuZ2V0SXRlbSgnc2VuaGFPdXRyYXNJbmZvcycpIHx8ICcxMjM0JzsKbGV0IHRhYmVsYURhZG9zID0gW107CmZ1bmN0aW9uIGF0dWFsaXphclRvdGFsKCkgewogIHZhciBlbCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCJ0b3RhbFZlaWN1bG9zIik7CiAgaWYgKGVsKSB7IGVsLnRleHRDb250ZW50ID0gIlRvdGFsIGRlIHZlw61jdWxvczogIiArIHRhYmVsYURhZG9zLmxlbmd0aDsgfQp9Cgpkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKCJET01Db250ZW50TG9hZGVkIiwgYXN5bmMgKCkgPT4gewoKICAvLyA9PT09PSBNZWxob3JpYSBWaXN1YWw6IGFwbGljYXIgY2FkZWFkbywgYmFkZ2UgZSB0b29sdGlwIG5vcyBjYW1wb3MgYmxvcXVlYWRvcyA9PT09PQogIGZ1bmN0aW9uIGVuaGFuY2VMb2NrZWRGaWVsZChpbnB1dEVsLCB0b29sdGlwVGV4dCl7CiAgICBpZighaW5wdXRFbCkgcmV0dXJuOwogICAgLy8gZ2FyYW50aXIgY2xhc3NlIGRlIHRvb2x0aXAgbm8gbGFiZWwKICAgIGNvbnN0IGxhYmVsID0gaW5wdXRFbC5jbG9zZXN0KCdsYWJlbCcpOwogICAgaWYobGFiZWwpewogICAgICBsYWJlbC5zdHlsZS5wb3NpdGlvbiA9ICdyZWxhdGl2ZSc7CiAgICAgIGxhYmVsLmNsYXNzTGlzdC5hZGQoJ2hhcy10b29sdGlwJyk7CiAgICAgIGlmKCFsYWJlbC5nZXRBdHRyaWJ1dGUoJ2RhdGEtdG9vbHRpcCcpKXsKICAgICAgICBsYWJlbC5zZXRBdHRyaWJ1dGUoJ2RhdGEtdG9vbHRpcCcsIHRvb2x0aXBUZXh0IHx8ICdEZWZpbmlkbyBubyBsb2dpbicpOwogICAgICB9CiAgICAgIC8vIGluc2VyaXIgaW5kaWNhZG9yIGNvbSDDrWNvbmUgZGUgY2FkZWFkbwogICAgICBpZighbGFiZWwucXVlcnlTZWxlY3RvcignLmxvY2staW5kaWNhdG9yJykpewogICAgICAgIGNvbnN0IGJhZGdlID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnc3BhbicpOwogICAgICAgIGJhZGdlLmNsYXNzTmFtZSA9ICdsb2NrLWluZGljYXRvcic7CiAgICAgICAgYmFkZ2UuaW5uZXJIVE1MID0gJzxpIGRhdGEtZmVhdGhlcj0ibG9jayI+PC9pPic7CiAgICAgICAgbGFiZWwuYXBwZW5kQ2hpbGQoYmFkZ2UpOwogICAgICB9CiAgICB9CiAgfQogIC8vIGFwbGljYXIgbWVsaG9yaWFzIHZpc3VhaXMgbmFzIGVudHJhZGFzIGJsb3F1ZWFkYXMKICBlbmhhbmNlTG9ja2VkRmllbGQoZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3R1cm5vJyksICdEZWZpbmlkbyBubyBsb2dpbicpOwogIGVuaGFuY2VMb2NrZWRGaWVsZChkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnY29udHJvbGFkb3JBY2Vzc28nKSwgJ0RlZmluaWRvIG5vIGxvZ2luJyk7CiAgZW5oYW5jZUxvY2tlZEZpZWxkKGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdzZXRvcicpLCAnVmFsb3IgZml4byBkYSBww6FnaW5hJyk7CiAgLy8gT3BjaW9uYWw6IHNlIGV4aXN0aXIgInNldG9yIiByZWFkb25seSwgYXBlbmFzIHZpc3VhbCAobsOjbyBhbHRlcmEgcmVncmFzIGRlIGJsb3F1ZWlvKQogIChmdW5jdGlvbigpewogICAgY29uc3Qgc2V0b3IgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnc2V0b3InKTsKICAgIGlmKHNldG9yICYmIHNldG9yLmhhc0F0dHJpYnV0ZSgncmVhZG9ubHknKSl7CiAgICAgIGVuaGFuY2VMb2NrZWRGaWVsZChzZXRvciwgJ1ZhbG9yIGZpeG8gZGEgcMOhZ2luYScpOwogICAgfQogIH0pKCk7CiAgLy8gY29tbyBhZGljaW9uYW1vcyBub3ZvcyDDrWNvbmVzIGRpbmFtaWNhbWVudGUsIHN1YnN0aXR1aXIgZmVhdGhlciBub3ZhbWVudGUKICBpZiAod2luZG93LmZlYXRoZXIgJiYgdHlwZW9mIGZlYXRoZXIucmVwbGFjZSA9PT0gJ2Z1bmN0aW9uJykgZmVhdGhlci5yZXBsYWNlKCk7CgogIGZlYXRoZXIucmVwbGFjZSgpOwogIHRhYmVsYURhZG9zID0gSlNPTi5wYXJzZShsb2NhbFN0b3JhZ2UuZ2V0SXRlbShzdG9yYWdlS2V5KSkgfHwgW107CiAgZnVuY3Rpb24gc2FsdmFyTG9jYWwoKXsgbG9jYWxTdG9yYWdlLnNldEl0ZW0oc3RvcmFnZUtleSwgSlNPTi5zdHJpbmdpZnkodGFiZWxhRGFkb3MpKTsgfQogIGZ1bmN0aW9uIGF0dWFsaXphclRhYmVsYSgpIHsKICBhdHVhbGl6YXJUb3RhbCgpOwogICAgY29uc3QgdGJvZHkgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCIjdGFiZWxhQ2hhc3NpIHRib2R5Iik7CiAgICB0Ym9keS5pbm5lckhUTUwgPSAiIjsKICAgIHRhYmVsYURhZG9zLmZvckVhY2goaXRlbSA9PiB7CiAgICAgIGNvbnN0IHRyID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgidHIiKTsKICAgICAgdHIuaW5uZXJIVE1MID0gYAogICAgICAgIDx0ZD4ke2l0ZW0uc2V0b3J9PC90ZD48dGQ+JHtpdGVtLnR1cm5vfTwvdGQ+PHRkPiR7aXRlbS5jb250cm9sYWRvcn08L3RkPjx0ZD4ke2l0ZW0uY2hhc3NpfTwvdGQ+PHRkPiR7aXRlbS5kYXRhSG9yYX08L3RkPgogICAgICBgOwogICAgICB0Ym9keS5hcHBlbmRDaGlsZCh0cik7CiAgICB9KTsKICB9CiAgd2luZG93LmFkaWNpb25hckl0ZW0gPSBhc3luYyAoKSA9PiB7CiAgYXR1YWxpemFyVG90YWwoKTsKICAgIGNvbnN0IGluZm8gPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgiaW5mbyIpOwogICAgY29uc3QgaW5wdXRDaGFzc2kgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgibnVtZXJvQ2hhc3NpIik7CiAgICBjb25zdCBpY29uQ29uZmlybSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCJjaGFzc2lDb25maXJtSWNvbiIpOwogICAgY29uc3QgY2hhc3NpID0gaW5wdXRDaGFzc2kudmFsdWUudHJpbSgpOwogICAgY29uc3QgY29udHJvbGFkb3IgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgiY29udHJvbGFkb3JBY2Vzc28iKS52YWx1ZS50cmltKCk7CiAgICBpZiAoIWNoYXNzaSkgewogICAgICBpbmZvLnRleHRDb250ZW50ID0gIkRpZ2l0ZSBvIG7Dum1lcm8gZGUgY2hhc3NpLiI7CiAgICAgIGlucHV0Q2hhc3NpLmZvY3VzKCk7CiAgICAgIHJldHVybjsKICAgIH0KICAgIGlmICghY29udHJvbGFkb3IpIHsKICAgICAgaW5mby50ZXh0Q29udGVudCA9ICJQcmVlbmNoYSBvIGNvbnRyb2xhZG9yIGRlIGFjZXNzby4iOwogICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgiY29udHJvbGFkb3JBY2Vzc28iKS5mb2N1cygpOwogICAgICByZXR1cm47CiAgICB9CiAgICB0YWJlbGFEYWRvcy5wdXNoKHsKICAgICAgc2V0b3I6IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCJzZXRvciIpLnZhbHVlLAogICAgICB0dXJubzogZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoInR1cm5vIikudmFsdWUsCiAgICAgIGNvbnRyb2xhZG9yOiBjb250cm9sYWRvciwKICAgICAgY2hhc3NpOiBjaGFzc2ksCiAgICAgIGRhdGFIb3JhOiBuZXcgRGF0ZSgpLnRvTG9jYWxlU3RyaW5nKCJwdC1CUiIpCiAgICB9KTsKICAgIHNhbHZhckxvY2FsKCk7CiAgICBhdHVhbGl6YXJUYWJlbGEoKTsKICAgIGlucHV0Q2hhc3NpLnZhbHVlID0gIiI7CiAgICBpbmZvLnRleHRDb250ZW50ID0gIk7CsCBkZSBjaGFzc2kgYWRpY2lvbmFkbyAtICIgKyBjaGFzc2k7CiAgICBpY29uQ29uZmlybS5jbGFzc0xpc3QuYWRkKCJ2aXNpYmxlIik7CiAgICBmZWF0aGVyLnJlcGxhY2UoKTsKICAgIHNldFRpbWVvdXQoKCkgPT4geyBpY29uQ29uZmlybS5jbGFzc0xpc3QucmVtb3ZlKCJ2aXNpYmxlIik7IH0sIDE1MDApOwogICAgaW5wdXRDaGFzc2kuZm9jdXMoKTsKICB9OwoKICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgibnVtZXJvQ2hhc3NpIikuYWRkRXZlbnRMaXN0ZW5lcigia2V5cHJlc3MiLCBlID0+IHsKICAgIGlmIChlLmtleSA9PT0gIkVudGVyIikgewogICAgICB3aW5kb3cuYWRpY2lvbmFySXRlbSgpOwogICAgfQogIH0pOwoKICB3aW5kb3cuZGVzZmF6ZXJVbHRpbW8gPSBhc3luYyAoKSA9PiB7CiAgYXR1YWxpemFyVG90YWwoKTsKICAgIGNvbnN0IGluZm8gPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgiaW5mbyIpOwogICAgaWYgKCF0YWJlbGFEYWRvcy5sZW5ndGgpIHsgYXdhaXQgc2hvd01vZGFsKCJOYWRhIHBhcmEgZGVzZmF6ZXIuIik7IHJldHVybjsgfQogICAgdGFiZWxhRGFkb3MucG9wKCk7CiAgICBzYWx2YXJMb2NhbCgpOwogICAgYXR1YWxpemFyVGFiZWxhKCk7CiAgICBpbmZvLnRleHRDb250ZW50ID0gIsOabHRpbW8gaXRlbSByZW1vdmlkby4iOwogIH07CiAgd2luZG93LmZpbmFsaXphclR1cm5vID0gYXN5bmMgKCkgPT4gewogIGF0dWFsaXphclRvdGFsKCk7CiAgICBjb25zdCBpbmZvID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoImluZm8iKTsKICAgIGlmICghdGFiZWxhRGFkb3MubGVuZ3RoKSB7IGF3YWl0IHNob3dNb2RhbCgiTmFkYSBwYXJhIGV4cG9ydGFyLiIpOyByZXR1cm47IH0KICAgIGlmICghYXdhaXQgc2hvd0NvbmZpcm0oIkRlc2VqYSBmaW5hbGl6YXIgbyB0dXJubyBlIGV4cG9ydGFyIGEgcGxhbmlsaGE/IikpIHJldHVybjsKICAgIHRyeSB7CiAgICAgIGNvbnN0IEV4Y2VsSlMgPSB3aW5kb3cuRXhjZWxKUzsKICAgICAgY29uc3Qgd29ya2Jvb2sgPSBuZXcgRXhjZWxKUy5Xb3JrYm9vaygpOwogICAgICBjb25zdCB3b3Jrc2hlZXQgPSB3b3JrYm9vay5hZGRXb3Jrc2hlZXQoIkNvbnRyb2xlQ2hhc3NpIik7CiAgICAgIHdvcmtzaGVldC5jb2x1bW5zID0gWwogICAgICAgIHsgaGVhZGVyOiAnU2V0b3InLCBrZXk6ICdzZXRvcicsIHdpZHRoOiAxOCB9LAogICAgICAgIHsgaGVhZGVyOiAnVHVybm8nLCBrZXk6ICd0dXJubycsIHdpZHRoOiAxMiB9LAogICAgICAgIHsgaGVhZGVyOiAnQ29udHJvbGFkb3IgZGUgYWNlc3NvJywga2V5OiAnY29udHJvbGFkb3InLCB3aWR0aDogMjQgfSwKICAgICAgICB7IGhlYWRlcjogJ07Dum1lcm8gZGUgY2hhc3NpJywga2V5OiAnY2hhc3NpJywgd2lkdGg6IDIyIH0sCiAgICAgICAgeyBoZWFkZXI6ICdEYXRhIGUgSG9yYScsIGtleTogJ2RhdGFIb3JhJywgd2lkdGg6IDIyIH0KICAgICAgXTsKICAgICAgdGFiZWxhRGFkb3MuZm9yRWFjaChkYWRvID0+IHdvcmtzaGVldC5hZGRSb3coZGFkbykpOwogICAgICB3b3Jrc2hlZXQucHJvdGVjdCgnMTIzNCcsIHsgc2VsZWN0TG9ja2VkQ2VsbHM6IHRydWUsIHNlbGVjdFVubG9ja2VkQ2VsbHM6IGZhbHNlLCBmb3JtYXRDZWxsczogZmFsc2UsIGZvcm1hdENvbHVtbnM6IGZhbHNlLCBmb3JtYXRSb3dzOiBmYWxzZSwgaW5zZXJ0Q29sdW1uczogZmFsc2UsIGluc2VydFJvd3M6IGZhbHNlLCBpbnNlcnRIeXBlcmxpbmtzOiBmYWxzZSwgZGVsZXRlQ29sdW1uczogZmFsc2UsIGRlbGV0ZVJvd3M6IGZhbHNlLCBzb3J0OiBmYWxzZSwgYXV0b0ZpbHRlcjogZmFsc2UsIHBpdm90VGFibGVzOiBmYWxzZSwgb2JqZWN0czogZmFsc2UsIHNjZW5hcmlvczogZmFsc2UgfSk7CiAgICAgIHdvcmtzaGVldC5lYWNoUm93KHJvdyA9PiB7IHJvdy5wcm90ZWN0aW9uID0geyBsb2NrZWQ6IHRydWUgfTsgfSk7CiAgICAgIGNvbnN0IGJ1ZmZlciA9IGF3YWl0IHdvcmtib29rLnhsc3gud3JpdGVCdWZmZXIoKTsKICAgICAgQXBwVUkuc2V0UHJvZ3Jlc3MoOTAsJ1NhbHZhbmRvIGFycXVpdm8nKTsKICAgICAgd3JpdGVCdWZmZXIoKTsKICAgICAgY29uc3QgYmxvYiA9IG5ldyBCbG9iKFtidWZmZXJdLCB7IHR5cGU6ICJhcHBsaWNhdGlvbi92bmQub3BlbnhtbGZvcm1hdHMtb2ZmaWNlZG9jdW1lbnQuc3ByZWFkc2hlZXRtbC5zaGVldCIgfSk7CiAgICAgIHNhdmVBcyhibG9iLCBgQ29udHJvbGVDaGFzc2lfJHtuZXcgRGF0ZSgpLnRvSVNPU3RyaW5nKCkuc2xpY2UoMCwxOSkucmVwbGFjZSgvW1Q6XS9nLCJfIil9Lnhsc3hgKTsKICAgICAgdGFiZWxhRGFkb3MubGVuZ3RoID0gMDsgc2FsdmFyTG9jYWwoKTsgYXR1YWxpemFyVGFiZWxhKCk7CiAgICAgIGluZm8udGV4dENvbnRlbnQgPSAiVHVybm8gZmluYWxpemFkbyBlIHBsYW5pbGhhIHByb3RlZ2lkYSBnZXJhZGEuIjsKICAgIH0gY2F0Y2ggKGUpIHsKICAgICAgaW5mby50ZXh0Q29udGVudCA9ICJFcnJvIGFvIGdlcmFyIHBsYW5pbGhhLiI7CiAgICB9CiAgfTsKICB3aW5kb3cudG9nZ2xlVGFiZWxhID0gKCkgPT4gewogICAgY29uc3QgY29udGFpbmVyID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoInRhYmVsYUNvbnRhaW5lciIpOwogICAgY29uc3QgYnRuID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoImJ0blRvZ2dsZVRhYmVsYSIpOwogICAgY29uc3QgaXNIaWRkZW4gPSAhY29udGFpbmVyLnN0eWxlLmRpc3BsYXkgfHwgY29udGFpbmVyLnN0eWxlLmRpc3BsYXkgPT09ICJub25lIjsKICAgIGNvbnRhaW5lci5zdHlsZS5kaXNwbGF5ID0gaXNIaWRkZW4gPyAiYmxvY2siIDogIm5vbmUiOwogICAgYnRuLmlubmVySFRNTCA9IGlzSGlkZGVuCiAgICAgID8gJzxpIGRhdGEtZmVhdGhlcj0iZXllLW9mZiI+PC9pPk9jdWx0YXIgVGFiZWxhJwogICAgICA6ICc8aSBkYXRhLWZlYXRoZXI9ImV5ZSI+PC9pPlZpc3VhbGl6YXIgVGFiZWxhJzsKICAgIGZlYXRoZXIucmVwbGFjZSgpOwogIH07CiAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ251bWVyb0NoYXNzaScpLnZhbHVlID0gbG9jYWxTdG9yYWdlLmdldEl0ZW0oJ2RyYWZ0Q2hhc3NpJykgfHwgJyc7CiAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2NvbnRyb2xhZG9yQWNlc3NvJykudmFsdWUgPSBsb2NhbFN0b3JhZ2UuZ2V0SXRlbSgidXN1YXJpbyIpICsgIiAvICIgKyBsb2NhbFN0b3JhZ2UuZ2V0SXRlbSgicmVnaXN0cm8iKTsKICBhdHVhbGl6YXJUYWJlbGEoKTsKICBvY3VsdGFyQm90b2VzSW50ZXJub3MoKTsKCiAgaWYgKHRhYmVsYURhZG9zLmxlbmd0aCkgeyBhd2FpdCBzaG93TW9kYWwoJ0RhZG9zIHJlc3RhdXJhZG9zLicpOyB9Cn0pOwp3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcignYmVmb3JldW5sb2FkJywgKCkgPT4gewogIGxvY2FsU3RvcmFnZS5zZXRJdGVtKCdkcmFmdENoYXNzaScsIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdudW1lcm9DaGFzc2knKS52YWx1ZSk7CiAgbG9jYWxTdG9yYWdlLnNldEl0ZW0oJ2RyYWZ0Q29udHJvbGFkb3InLCBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnY29udHJvbGFkb3JBY2Vzc28nKS52YWx1ZSk7Cn0pOwp3aW5kb3cuc2FpciA9IGFzeW5jICgpID0+IHsKICBpZiAoYXdhaXQgc2hvd0NvbmZpcm0oIlRlbSBjZXJ0ZXphIHF1ZSBkZXNlamEgc2Fpcj8iKSkgewogICAgd2luZG93LmxvY2F0aW9uLmhyZWYgPSAnaW50ZXJmYWNlX3ByaW5jaXBhbC5odG1sJzsKICB9Cn07Cgphc3luYyBmdW5jdGlvbiBhY2Vzc2FyT3V0cmFzSW5mb3MoKSB7CiAgY29uc3Qgc2VuaGEgPSBhd2FpdCBzaG93UHJvbXB0KCdEaWdpdGUgYSBzZW5oYSBkZSA0IGTDrWdpdG9zOicpOwogIGlmIChzZW5oYSA9PT0gc2VuaGFPdXRyYXNJbmZvcykgewogICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2JvdG9lc0ludGVybm9zJykuc3R5bGUuZGlzcGxheSA9ICdmbGV4JzsKICB9IGVsc2UgewogICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2JvdG9lc0ludGVybm9zJykuc3R5bGUuZGlzcGxheSA9ICdub25lJzsKICAgIGF3YWl0IHNob3dNb2RhbCgnU2VuaGEgaW5jb3JyZXRhLicpOwogIH0KfQpmdW5jdGlvbiBvY3VsdGFyQm90b2VzSW50ZXJub3MoKSB7CiAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2JvdG9lc0ludGVybm9zJykuc3R5bGUuZGlzcGxheSA9ICdub25lJzsKfQphc3luYyBmdW5jdGlvbiBlZGl0YXJTZW5oYSgpIHsKICBjb25zdCBhdHVhbCA9IGF3YWl0IHNob3dQcm9tcHQoJ0RpZ2l0ZSBhIHNlbmhhIGF0dWFsOicpOwogIGlmIChhdHVhbCAhPT0gc2VuaGFPdXRyYXNJbmZvcykgewogICAgYXdhaXQgc2hvd01vZGFsKCdTZW5oYSBpbmNvcnJldGEhJyk7CiAgICByZXR1cm47CiAgfQogIGNvbnN0IG5vdmEgPSBhd2FpdCBzaG93UHJvbXB0KCdEaWdpdGUgYSBub3ZhIHNlbmhhIGRlIDQgZMOtZ2l0b3M6Jyk7CiAgaWYgKG5vdmEgJiYgbm92YS5sZW5ndGggPT09IDQgJiYgL15cZCskLy50ZXN0KG5vdmEpKSB7CiAgICBzZW5oYU91dHJhc0luZm9zID0gbm92YTsKICAgIGxvY2FsU3RvcmFnZS5zZXRJdGVtKCdzZW5oYU91dHJhc0luZm9zJywgbm92YSk7CiAgICBhd2FpdCBzaG93TW9kYWwoJ1NlbmhhIGFsdGVyYWRhIGNvbSBzdWNlc3NvIScpOwogICAgb2N1bHRhckJvdG9lc0ludGVybm9zKCk7CiAgfSBlbHNlIHsKICAgIGF3YWl0IHNob3dNb2RhbCgnU2VuaGEgaW52w6FsaWRhIScpOwogIH0KfQ=='))</script><script>eval(atob('ZnVuY3Rpb24gc2hvd1RvYXN0KG1lc3NhZ2UsIGR1cmF0aW9uID0gMzAwMCkgewogIGNvbnN0IGNvbnRhaW5lciA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCd0b2FzdC1jb250YWluZXInKTsKICBjb25zdCB0b2FzdCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpOwogIHRvYXN0LmNsYXNzTmFtZSA9ICd0b2FzdCc7CiAgdG9hc3QudGV4dENvbnRlbnQgPSBtZXNzYWdlOwogIGNvbnRhaW5lci5hcHBlbmRDaGlsZCh0b2FzdCk7CiAgc2V0VGltZW91dCgoKSA9PiB7CiAgICB0b2FzdC5hZGRFdmVudExpc3RlbmVyKCdhbmltYXRpb25lbmQnLCAoKSA9PiB0b2FzdC5yZW1vdmUoKSk7CiAgICB0b2FzdC5zdHlsZS5hbmltYXRpb24gPSAnZmFkZU91dCAwLjRzIGVhc2UtaW4gZm9yd2FyZHMnOwogIH0sIGR1cmF0aW9uKTsKfQoKd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoJ0RPTUNvbnRlbnRMb2FkZWQnLCAoKSA9PiB7CiAgZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnZm9ybScpLmZvckVhY2goZm9ybSA9PiB7CiAgICBmb3JtLmFkZEV2ZW50TGlzdGVuZXIoJ3N1Ym1pdCcsIGUgPT4gewogICAgICBlLnByZXZlbnREZWZhdWx0KCk7CiAgICAgIC8vIHN1YnN0aXR1aXIgbMOzZ2ljYSByZWFsIGFxdWkKICAgICAgY29uc3Qgc3VjZXNzbyA9IHRydWU7IC8vIG91IGZhbHNlIGNvbmZvcm1lIHZhbGlkYcOnw6NvCiAgICAgIGlmIChzdWNlc3NvKSB7CiAgICAgICAgc2hvd1RvYXN0KCdBw6fDo28gcmVhbGl6YWRhIGNvbSBzdWNlc3NvIScpOwogICAgICB9IGVsc2UgewogICAgICAgIHNob3dUb2FzdCgnT2NvcnJldSB1bSBlcnJvLiBUZW50ZSBub3ZhbWVudGUuJyk7CiAgICAgIH0KICAgIH0pOwogIH0pOwp9KTs='))</script><script>eval(atob('KGZ1bmN0aW9uKCl7CiAgZnVuY3Rpb24gZ2V0RWwoaWQpeyByZXR1cm4gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoaWQpOyB9CiAgZnVuY3Rpb24gc2F2ZVN0YXRlKCl7CiAgICB0cnl7CiAgICAgIGNvbnN0IHN0YXRlID0gewogICAgICAgIHNldG9yOiBnZXRFbCgnc2V0b3InKSA/IGdldEVsKCdzZXRvcicpLnZhbHVlIDogbnVsbCwKICAgICAgICB0dXJubzogZ2V0RWwoJ3R1cm5vJykgPyBnZXRFbCgndHVybm8nKS52YWx1ZSA6IG51bGwsCiAgICAgICAgbnVtZXJvQ2hhc3NpOiBnZXRFbCgnbnVtZXJvQ2hhc3NpJykgPyBnZXRFbCgnbnVtZXJvQ2hhc3NpJykudmFsdWUgOiBudWxsLAogICAgICAgIGNvbnRyb2xhZG9yQWNlc3NvOiBnZXRFbCgnY29udHJvbGFkb3JBY2Vzc28nKSA/IGdldEVsKCdjb250cm9sYWRvckFjZXNzbycpLnZhbHVlIDogbnVsbCwKICAgICAgICB0YWJlbGE6IChmdW5jdGlvbigpeyB0cnl7IHJldHVybiBKU09OLnBhcnNlKGxvY2FsU3RvcmFnZS5nZXRJdGVtKCd0YWJlbGFDaGFzc2knKSl8fFtdOyB9Y2F0Y2goZSl7cmV0dXJuIFtdfSB9KSgpCiAgICAgIH07CiAgICAgIGxvY2FsU3RvcmFnZS5zZXRJdGVtKCdjb250cm9sZV9pbmR1c3RyaWFsaXphY2FvX2VzdGFkbycsIEpTT04uc3RyaW5naWZ5KHN0YXRlKSk7CiAgICAgIGNvbnN0IGljbyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5hdXRvLXNhdmUtaWNvbicpOwogICAgICBpZiAoaWNvKSB7IGljby50ZXh0Q29udGVudCA9ICfwn5K+IFNhbHZhbWVudG8gYXV0b23DoXRpY28nOyB9CiAgICB9Y2F0Y2goZSl7IGNvbnNvbGUud2FybignRmFsaGEgYW8gc2FsdmFyIGVzdGFkbzonLCBlKTsgfQogIH0KICBmdW5jdGlvbiByZXN0b3JlU3RhdGUoKXsKICAgIHRyeXsKICAgICAgY29uc3QgcmF3ID0gbG9jYWxTdG9yYWdlLmdldEl0ZW0oJ2NvbnRyb2xlX2luZHVzdHJpYWxpemFjYW9fZXN0YWRvJyk7CiAgICAgIGlmICghcmF3KSByZXR1cm47CiAgICAgIGNvbnN0IHN0YXRlID0gSlNPTi5wYXJzZShyYXcpOwogICAgICBpZiAoc3RhdGUuc2V0b3IgJiYgZ2V0RWwoJ3NldG9yJykpIGdldEVsKCdzZXRvcicpLnZhbHVlID0gc3RhdGUuc2V0b3I7CiAgICAgIGlmIChzdGF0ZS50dXJubyAmJiBnZXRFbCgndHVybm8nKSkgewogICAgICAgIGNvbnN0IHNlbCA9IGdldEVsKCd0dXJubycpOwogICAgICAgIGNvbnN0IGV4aXN0cyA9IEFycmF5LmZyb20oc2VsLm9wdGlvbnMpLnNvbWUobyA9PiAoby52YWx1ZT09PXN0YXRlLnR1cm5vfHxvLnRleHQ9PT1zdGF0ZS50dXJubykpOwogICAgICAgIGlmKCFleGlzdHMpeyBjb25zdCBvcHQ9ZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnb3B0aW9uJyk7IG9wdC52YWx1ZT1zdGF0ZS50dXJubzsgb3B0LnRleHRDb250ZW50PXN0YXRlLnR1cm5vOyBzZWwuYXBwZW5kQ2hpbGQob3B0KTsgfQogICAgICAgIHNlbC52YWx1ZSA9IHN0YXRlLnR1cm5vOwogICAgICB9CiAgICAgIGlmIChzdGF0ZS5udW1lcm9DaGFzc2kgJiYgZ2V0RWwoJ251bWVyb0NoYXNzaScpKSBnZXRFbCgnbnVtZXJvQ2hhc3NpJykudmFsdWUgPSBzdGF0ZS5udW1lcm9DaGFzc2k7CiAgICAgIGlmIChzdGF0ZS5jb250cm9sYWRvckFjZXNzbyAmJiBnZXRFbCgnY29udHJvbGFkb3JBY2Vzc28nKSkgZ2V0RWwoJ2NvbnRyb2xhZG9yQWNlc3NvJykudmFsdWUgPSBzdGF0ZS5jb250cm9sYWRvckFjZXNzbzsKICAgICAgaWYgKEFycmF5LmlzQXJyYXkoc3RhdGUudGFiZWxhKSAmJiBzdGF0ZS50YWJlbGEubGVuZ3RoICYmICFsb2NhbFN0b3JhZ2UuZ2V0SXRlbSgndGFiZWxhQ2hhc3NpJykpIHsKICAgICAgICBsb2NhbFN0b3JhZ2Uuc2V0SXRlbSgndGFiZWxhQ2hhc3NpJywgSlNPTi5zdHJpbmdpZnkoc3RhdGUudGFiZWxhKSk7CiAgICAgIH0KICAgIH1jYXRjaChlKXsgY29uc29sZS53YXJuKCdGYWxoYSBhbyByZXN0YXVyYXIgZXN0YWRvOicsIGUpOyB9CiAgfQogIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKCdiZWZvcmV1bmxvYWQnLCBzYXZlU3RhdGUpOwogIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ2lucHV0JywgZnVuY3Rpb24oZSl7CiAgICBjb25zdCBpZCA9IGUudGFyZ2V0ICYmIGUudGFyZ2V0LmlkOwogICAgaWYgKFsnc2V0b3InLCd0dXJubycsJ251bWVyb0NoYXNzaScsJ2NvbnRyb2xhZG9yQWNlc3NvJ10uaW5jbHVkZXMoaWQpKSB7CiAgICAgIGNsZWFyVGltZW91dCh3aW5kb3cuX19zYXZlX2RlYm91bmNlKTsKICAgICAgd2luZG93Ll9fc2F2ZV9kZWJvdW5jZSA9IHNldFRpbWVvdXQoc2F2ZVN0YXRlLCAyMDApOwogICAgfQogIH0pOwogIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ0RPTUNvbnRlbnRMb2FkZWQnLCBmdW5jdGlvbigpewogICAgcmVzdG9yZVN0YXRlKCk7CiAgICBbJ2J0bkFkaWNpb25hcicsJ2J0bkRlc2ZhemVyJywnYnRuRWRpdGFyU2VuaGEnLCdidG5GZWNoYXJCb3RvZXNJbnRlcm5vcycsJ2J0blRvZ2dsZVRhYmVsYScsJ2J0bk91dHJhc0luZm9zJ10uZm9yRWFjaChpZD0+ewogICAgICBjb25zdCBiID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoaWQpOyBpZiAoYikgYi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIHNhdmVTdGF0ZSk7CiAgICB9KTsKICB9KTsKICBjb25zdCBvbGRTYWlyID0gd2luZG93LnNhaXI7CiAgd2luZG93LnNhaXIgPSBhc3luYyAoKSA9PiB7CiAgICB0cnkgewogICAgICBpZiAodHlwZW9mIG9sZFNhaXIgPT09ICdmdW5jdGlvbicpIHsgcmV0dXJuIGF3YWl0IG9sZFNhaXIoKTsgfQogICAgfSBjYXRjaChlKSB7IGNvbnNvbGUud2FybihlKTsgfQogICAgaWYgKHR5cGVvZiBzaG93Q29uZmlybSA9PT0gJ2Z1bmN0aW9uJykgewogICAgICBpZiAoYXdhaXQgc2hvd0NvbmZpcm0oJ1RlbSBjZXJ0ZXphIHF1ZSBkZXNlamEgc2Fpcj8nKSkgewogICAgICAgIHdpbmRvdy5sb2NhdGlvbi5ocmVmID0gJ2ludGVyZmFjZV9wcmluY2lwYWwuaHRtbCc7CiAgICAgIH0KICAgIH0gZWxzZSB7CiAgICAgIGlmIChjb25maXJtKCdUZW0gY2VydGV6YSBxdWUgZGVzZWphIHNhaXI/JykpIHsKICAgICAgICB3aW5kb3cubG9jYXRpb24uaHJlZiA9ICdpbnRlcmZhY2VfcHJpbmNpcGFsLmh0bWwnOwogICAgICB9CiAgICB9CiAgfTsKfSkoKTs='))</script><script>eval(atob('Ly8gPT09IFNhbHZhbWVudG8gYXV0b23DoXRpY28gZGUgdG9kb3Mgb3MgY2FtcG9zID09PQpkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKCdET01Db250ZW50TG9hZGVkJywgZnVuY3Rpb24oKSB7CiAgY29uc3QgZm9ybSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJ2Zvcm0nKSB8fCBkb2N1bWVudC5ib2R5OwogIC8vIFJlc3RhdXJhciBkYWRvcwogIGNvbnN0IHNhdmVkRGF0YSA9IEpTT04ucGFyc2UobG9jYWxTdG9yYWdlLmdldEl0ZW0oJ2NvbnRyb2xlVmVpY3Vsb3NEYXRhJykgfHwgJ3t9Jyk7CiAgT2JqZWN0LmtleXMoc2F2ZWREYXRhKS5mb3JFYWNoKGlkID0+IHsKICAgIGNvbnN0IGVsID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoaWQpOwogICAgaWYgKGVsKSBlbC52YWx1ZSA9IHNhdmVkRGF0YVtpZF07CiAgfSk7CiAgLy8gU2FsdmFyIGF1dG9tw6F0aWNvCiAgZm9ybS5hZGRFdmVudExpc3RlbmVyKCdpbnB1dCcsIGZ1bmN0aW9uKGUpIHsKICAgIGNvbnN0IGlucHV0cyA9IGZvcm0ucXVlcnlTZWxlY3RvckFsbCgnaW5wdXQsIHNlbGVjdCwgdGV4dGFyZWEnKTsKICAgIGNvbnN0IGRhdGEgPSB7fTsKICAgIGlucHV0cy5mb3JFYWNoKGlucCA9PiB7CiAgICAgIGlmIChpbnAuaWQpIGRhdGFbaW5wLmlkXSA9IGlucC52YWx1ZTsKICAgIH0pOwogICAgbG9jYWxTdG9yYWdlLnNldEl0ZW0oJ2NvbnRyb2xlVmVpY3Vsb3NEYXRhJywgSlNPTi5zdHJpbmdpZnkoZGF0YSkpOwogIH0pOwoKICAvLyBCb3TDo28gU2FpciAtIHZvbHRhIHBhcmEgaW50ZXJmYWNlIHNlbSBhcGFnYXIgZGFkb3MKICBjb25zdCBzYWlyQnRuID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2J0blNhaXInKTsKICBpZiAoc2FpckJ0bikgewogICAgc2FpckJ0bi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGZ1bmN0aW9uKGV2KSB7CiAgICAgIGV2LnByZXZlbnREZWZhdWx0KCk7CiAgICAgIHdpbmRvdy5sb2NhdGlvbi5ocmVmID0gJ2ludGVyZmFjZV9wcmluY2lwYWwuaHRtbCc7CiAgICB9KTsKICB9Cn0pOwoKCgoKPHNjcmlwdD4KLy8gUmVmaW5vIGRlIGF1dG9zYXZlOiBvYnNlcnZhIGFsdGVyYcOnw7VlcyBuYSB0YWJlbGEgZSBzYWx2YSBlc3RhZG8Kd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoJ3N0b3JhZ2UnLCBmdW5jdGlvbihldil7CiAgaWYgKGV2ICYmIGV2LmtleSA9PT0gJ3RhYmVsYUNoYXNzaScpIHsKICAgIHRyeSB7IGlmICh0eXBlb2Ygc2F2ZVN0YXRlID09PSAnZnVuY3Rpb24nKSBzYXZlU3RhdGUoKTsgfSBjYXRjaChlKXt9CiAgfQp9KTs='))</script><script>eval(atob('Ly8gSGVscGVycyBkZSBleHBvcnRhw6fDo28KZnVuY3Rpb24gYmxvYkRvd25sb2FkKGNvbnRlbnQsIGZpbGVuYW1lLCB0eXBlKXsKICBjb25zdCBibG9iID0gbmV3IEJsb2IoW2NvbnRlbnRdLCB7dHlwZX0pOwogIGNvbnN0IHVybCA9IFVSTC5jcmVhdGVPYmplY3RVUkwoYmxvYik7CiAgY29uc3QgYSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2EnKTsKICBhLmhyZWYgPSB1cmw7CiAgYS5kb3dubG9hZCA9IGZpbGVuYW1lOwogIGRvY3VtZW50LmJvZHkuYXBwZW5kQ2hpbGQoYSk7CiAgYS5jbGljaygpOwogIHNldFRpbWVvdXQoKCkgPT4gewogICAgZG9jdW1lbnQuYm9keS5yZW1vdmVDaGlsZChhKTsKICAgIFVSTC5yZXZva2VPYmplY3RVUkwodXJsKTsKICB9LCAwKTsKfQpmdW5jdGlvbiBzZXJpYWxpemVGb3JtRmllbGRzKHNjb3BlKXsKICBjb25zdCByb290ID0gc2NvcGUgfHwgZG9jdW1lbnQ7CiAgY29uc3QgZGF0YSA9IHt9OwogIHJvb3QucXVlcnlTZWxlY3RvckFsbCgnaW5wdXQsIHNlbGVjdCwgdGV4dGFyZWEnKS5mb3JFYWNoKGVsPT57CiAgICBjb25zdCBrZXkgPSBlbC5uYW1lIHx8IGVsLmlkIHx8IGVsLmdldEF0dHJpYnV0ZSgnZGF0YS1rZXknKTsKICAgIGlmICgha2V5KSByZXR1cm47CiAgICBpZiAoZWwudHlwZSA9PT0gJ2NoZWNrYm94JykgZGF0YVtrZXldID0gZWwuY2hlY2tlZDsKICAgIGVsc2UgaWYgKGVsLnR5cGUgPT09ICdyYWRpbycpIHsgaWYgKGVsLmNoZWNrZWQpIGRhdGFba2V5XSA9IGVsLnZhbHVlOyB9CiAgICBlbHNlIGRhdGFba2V5XSA9IGVsLnZhbHVlOwogIH0pOwogIHJldHVybiBkYXRhOwp9CmZ1bmN0aW9uIHRhYmxlVG9BcnJheSh0YWJsZSl7CiAgaWYgKCF0YWJsZSkgcmV0dXJuIFtdOwogIGNvbnN0IHJvd3MgPSBbXTsKICBjb25zdCB0cnMgPSB0YWJsZS5xdWVyeVNlbGVjdG9yQWxsKCd0cicpOwogIHRycy5mb3JFYWNoKCh0ciwgaWR4KT0+ewogICAgY29uc3QgY2VsbHMgPSBBcnJheS5mcm9tKHRyLmNoaWxkcmVuKS5tYXAodGQ9PnRkLmlubmVyVGV4dC50cmltKCkpOwogICAgcm93cy5wdXNoKGNlbGxzKTsKICB9KTsKICByZXR1cm4gcm93czsKfQpmdW5jdGlvbiBhcnJheVRvQ1NWKGFycil7CiAgcmV0dXJuIGFyci5tYXAocm93ID0+IHJvdy5tYXAodiA9PiB7CiAgICBpZiAodiA9PSBudWxsKSByZXR1cm4gJyc7CiAgICBjb25zdCBzID0gU3RyaW5nKHYpLnJlcGxhY2UoLyIvZywnIiInKTsKICAgIHJldHVybiAvWyIsXG5dLy50ZXN0KHMpID8gYCIke3N9ImAgOiBzOwogIH0pLmpvaW4oJywnKSkuam9pbignXG4nKTsKfQ=='))</script><script>eval(atob('ZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignRE9NQ29udGVudExvYWRlZCcsIGZ1bmN0aW9uKCkgewogIHRyeSB7CiAgICB2YXIgdHVybm9TYWx2byA9IGxvY2FsU3RvcmFnZS5nZXRJdGVtKCd0dXJubycpOwogICAgdmFyIHR1cm5vc1ZhbGlkb3MgPSBbJ0FscGhhJywgJ0JyYXZvJywgJ0NoYXJsaWUnLCAnRGVsdGEnXTsKICAgIGlmICh0dXJub1NhbHZvICYmIHR1cm5vc1ZhbGlkb3MuaW5jbHVkZXModHVybm9TYWx2bykpIHsKICAgICAgdmFyIGNhbXBvVHVybm8gPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgndHVybm8nKTsKICAgICAgaWYgKGNhbXBvVHVybm8pIGNhbXBvVHVybm8udmFsdWUgPSB0dXJub1NhbHZvOwogICAgfSBlbHNlIHsKICAgICAgY29uc29sZS53YXJuKCdUdXJubyBpbnbDoWxpZG8gb3UgbsOjbyBkZWZpbmlkbzonLCB0dXJub1NhbHZvKTsKICAgIH0KICB9IGNhdGNoKGUpIHsKICAgIGNvbnNvbGUud2FybignRXJybyBhbyBjYXJyZWdhciB0dXJubyBkbyBsb2NhbFN0b3JhZ2U6JywgZSk7CiAgfQp9KTs='))</script></body></html>